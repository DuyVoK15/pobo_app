{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport axios from \"axios\";\nimport React, { createContext, useState } from \"react\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState({}),\n    _useState2 = _slicedToArray(_useState, 2),\n    userToken = _useState2[0],\n    setUserToken = _useState2[1];\n  var _useState3 = useState({}),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userTokenRegister = _useState4[0],\n    setUserTokenRegister = _useState4[1];\n  var _useState5 = useState({}),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userInfo = _useState6[0],\n    setUserInfo = _useState6[1];\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    isLoading = _useState8[0],\n    setIsLoading = _useState8[1];\n  var _useState9 = useState(false),\n    _useState10 = _slicedToArray(_useState9, 2),\n    isLogin = _useState10[0],\n    setIsLogin = _useState10[1];\n  var getUserInfo = function () {\n    var _ref2 = _asyncToGenerator(function* (userToken) {\n      try {\n        var response = yield axios.get(\"http://192.168.1.5:8448/api/v1/auth/info\", {\n          headers: {\n            Authorization: \"Bearer \" + userToken.accessToken,\n            \"Cache-Control\": \"no-cache\",\n            Pragma: \"no-cache\"\n          }\n        });\n        var _userInfo = response.data;\n        console.log(\"Thông tin user: \" + JSON.stringify(_userInfo));\n        setUserInfo(_userInfo);\n        AsyncStorage.setItem(\"userInfo\", JSON.stringify(_userInfo));\n      } catch (error) {\n        console.log(error);\n      }\n    });\n    return function getUserInfo(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var register = function register(name, username, email, password) {\n    setIsLoading(true);\n    axios.post(\"http://192.168.1.5:8448/api/v1/auth/register\", {\n      name: name,\n      username: username,\n      email: email,\n      password: password\n    }).then(function (response) {\n      var userTokenRegister = response.data;\n      setUserTokenRegister(userTokenRegister);\n      AsyncStorage.setItem(\"userTokenRegister\", JSON.stringify(userTokenRegister));\n      setIsLoading(false);\n      console.log(userInfoRegisger);\n    }).catch(function (error) {\n      console.log(error);\n      setIsLoading(false);\n    });\n  };\n  var login = function () {\n    var _ref3 = _asyncToGenerator(function* (username, password) {\n      setIsLoading(true);\n      axios.post(\"http://192.168.1.5:8448/api/v1/auth/login\", {\n        username: username,\n        password: password\n      }).then(function (response) {\n        var userToken = response.data;\n        setUserToken(userToken);\n        AsyncStorage.setItem(\"userToken\", JSON.stringify(userToken));\n        setIsLoading(false);\n        console.log(userToken);\n        getUserInfo(userToken);\n      }).catch(function (error) {\n        console.log(error);\n        setIsLoading(false);\n      });\n    });\n    return function login(_x2, _x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var logout = function logout() {\n    AsyncStorage.removeItem(\"userToken\");\n    AsyncStorage.removeItem(\"userTokenRegister\");\n    AsyncStorage.removeItem(\"userInfo\");\n    setUserToken({});\n    setUserInfo({});\n    setUserTokenRegister({});\n  };\n  return _jsx(AuthContext.Provider, {\n    value: {\n      isLoading: isLoading,\n      userToken: userToken,\n      userTokenRegister: userTokenRegister,\n      register: register,\n      login: login,\n      logout: logout,\n      isLogin: isLogin\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["AsyncStorage","axios","React","createContext","useState","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","userToken","setUserToken","_useState3","_useState4","userTokenRegister","setUserTokenRegister","_useState5","_useState6","userInfo","setUserInfo","_useState7","_useState8","isLoading","setIsLoading","_useState9","_useState10","isLogin","setIsLogin","getUserInfo","_ref2","_asyncToGenerator","response","get","headers","Authorization","accessToken","Pragma","data","console","log","JSON","stringify","setItem","error","_x","apply","arguments","register","name","username","email","password","post","then","userInfoRegisger","catch","login","_ref3","_x2","_x3","logout","removeItem","Provider","value"],"sources":["E:/Studying/Term 8/EXE201/PoBo/context/AuthContext.js"],"sourcesContent":["import AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport axios from \"axios\";\r\nimport React, { createContext, useState } from \"react\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [userToken, setUserToken] = useState({});\r\n  const [userTokenRegister, setUserTokenRegister] = useState({});\r\n  const [userInfo, setUserInfo] = useState({});\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isLogin, setIsLogin] = useState(false);\r\n\r\n  const getUserInfo = async (userToken) => {\r\n    // setIsLoading(true);\r\n    try {\r\n      const response = await axios.get(\r\n        \"http://192.168.1.5:8448/api/v1/auth/info\",\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${userToken.accessToken}`,\r\n            \"Cache-Control\": \"no-cache\",\r\n            Pragma: \"no-cache\",\r\n          },\r\n        }\r\n      );\r\n\r\n      let userInfo = response.data;\r\n      console.log(\"Thông tin user: \" + JSON.stringify(userInfo));\r\n      setUserInfo(userInfo);\r\n      AsyncStorage.setItem(\r\n        \"userInfo\",\r\n        JSON.stringify(userInfo)\r\n      );\r\n      \r\n      \r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  const register = (name, username, email, password) => {\r\n    // console.log(name + username + email + password)\r\n    setIsLoading(true);\r\n    axios\r\n      .post(\"http://192.168.1.5:8448/api/v1/auth/register\", {\r\n        name,\r\n        username,\r\n        email,\r\n        password,\r\n      })\r\n      .then((response) => {\r\n        let userTokenRegister = response.data;\r\n        setUserTokenRegister(userTokenRegister);\r\n        AsyncStorage.setItem(\r\n          \"userTokenRegister\",\r\n          JSON.stringify(userTokenRegister)\r\n        );\r\n        setIsLoading(false);\r\n        console.log(userInfoRegisger);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n        setIsLoading(false);\r\n      });\r\n  };\r\n\r\n  const login = async (username, password) => {\r\n    setIsLoading(true);\r\n    axios\r\n      .post(\"http://192.168.1.5:8448/api/v1/auth/login\", {\r\n        username,\r\n        password,\r\n      })\r\n      .then((response) => {\r\n        let userToken = response.data;\r\n        setUserToken(userToken);\r\n        AsyncStorage.setItem(\"userToken\", JSON.stringify(userToken));\r\n        setIsLoading(false);\r\n        console.log(userToken);\r\n        getUserInfo(userToken);\r\n        // setIsLogin(true);\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n        setIsLoading(false);\r\n        // setIsLogin(false);\r\n      });\r\n  };\r\n\r\n  const logout = () => {\r\n    AsyncStorage.removeItem(\"userToken\");\r\n    AsyncStorage.removeItem(\"userTokenRegister\");\r\n    AsyncStorage.removeItem(\"userInfo\");\r\n    setUserToken({});\r\n    setUserInfo({});\r\n    setUserTokenRegister({})\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        isLoading,\r\n        userToken,\r\n        userTokenRegister,\r\n        register,\r\n        login,\r\n        logout,\r\n        isLogin,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}